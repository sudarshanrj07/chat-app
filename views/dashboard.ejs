<%- include('layouts/header.ejs') %>

<h2 class="mb-4">Hi, <%= user.name %></h2>
<div class="row">
	<div class="col-md-3">
		<ul class="list-group">
			<% if(users.length>0){ for(let i =0; i<users.length;i++){ %>
			<li class="list-group-item list-group-item-dark cursor-pointer user-list" >
                <img src="<%= "http://localhost:3000/"+users[i].image %>" alt="" width="50px" height="50px">
                <%= users[i].name %></li>
			<% } } %>
		</ul>
	</div>
	<div class="col-md-9">
        <h3 class="start-head">click to start chat</h3>
        <div class="chat-section">
        
            <div id="chat-container">
            </div>
            <form action="" id="chat-form">
                <input type="text" name="message" id="message" class="border" placeholder="Enter message"required/>
                <input type="submit" value="Send message" class="btn btn-primary"/>    
            </form>
        </div>
        
    </div>
</div>
<script>
    const sender_id = '<%= user._id %>';
    const socket = io('/user-namespace',{
      auth: { token: sender_id,}
    });
    $(document).ready(()=>{
        $(".user-list").click(()=>{
            $(".start-head").hide();
            $(".chat-section").show();
        });
    })
</script>
<%- include('layouts/footer.ejs') %>
